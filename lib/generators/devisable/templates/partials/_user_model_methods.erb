  # Returns the user's email or username depending on which is set
  # @return [String] Return username unless it is blank, then return email
  def display_name
    return self.username.blank? ? self.email : self.username
  end

  class << self
    # Join to the user role habtm table that restricts output to super admins
    def superadmins
      joins("join roles_users on users.id = roles_users.user_id").where("roles_users.role_id = (select role_id from roles where name = 'SuperAdmin')");
    end
  end